<%@page import="util.Alpha"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="Coche-Control" content="no-store">
<link rel="icon" href="faviconAlpha.png">
<title>alpha_move.jsp</title>
<style type="text/css">
td#td1 {
	alian: right;
	background-color: pink;
}

td#td2 {
	alian: right;
	background-color: pink;
}

td#td3 {
	alian: right;
	background-color: pink;
}

main {
	position: relative;
	border-width: 10px;
	border-style: solid;
	border-color: orange;
	height: 500px;
}

html {
	border: 20px solid gray;
	margin: 0px;
}

body {
	border: 20px solid blue;
	margin: 0px;
}

span {
	position: absolute;
	font-family: monospace;
	font-size: 15pt;
}
</style>
<script type="text/javascript">
class Color {
	static Black = "blcak";
    static Red	= "red";
    static Green = "green";
    static Yellow = "yellow";
    static Blue = "blue";
    static Magenta = "magenta";
    static Cyan = "cyan";
    static White = "white";
    
    static values() {
    	return [Color.Black, Color.Red, Color.Green, 
    			Color.Yellow, Color.Blue, Color.Magenta,
    			Color.cyan, Color.white];
    };
}

class Alpha {
	constructor() {
		this.line = parseInt(1, 20);
		this.column = parseInt(1, 40);
		do {
			this.fg = Color.values()[parseInt(Math.random()*8)];
			this.bg = Color.values()[parseInt(Math.random()*8)];
		} while (this.fg===this.bg);
		this.ch = String.fromCharCode([parseInt(Math.random()*26+ 'A'.charCodeAt(0))] );
	}
	
	show() {
		let cell = table.rows[this.line-1].cells[this.column-1];
		cell.style.color = this.fg;
		cell.style.background = this.bg;
		cell.textContent = this.ch;
		cell.style.opacity = 1;
	}
	
	hide() {
		let cell = table.rows[this.line-1].cells[this.column-1];
		cell.style.opacity = 0;
	}
	
	move() {
		this.hide();
		
		if(this.line===1 && this.column < 40) {
			this.column++;
		} else if  (this.column === 40 && this.line < 20) {
            this.line++;
        } else if (this.line === 20 && this.column > 1) {
            this.column--;
        } else if (this.column === 1 && this.line > 1) {
            this.line--;
        }
	}
	
	isShow = true;
	blink() {
		if (this.isShow)
			this.show();
		else 
			this.hide();
		
		this.isShow = !this.isShow;
	}
}

const alphas = [];
for (let i=0; i<50; i++) {
	alphas.push(new Alpha());
}

setInterval(() => {
	for(const alpha of alphas) {
		//alpha.this.move();
		//alpha.this.show();
	}
}, 100);

</script>
<script type="text/javascript">
 window.onload = function() {
		let spans = document.querySelectorAll('span');
		
		let width = parseFloat(getComputedStyle(spans[0]).width);
		let height = parseFloat(getComputedStyle(spans[0]).height);
		
		let main = document.querySelector('main');
		main.style.height = 20*height + "px";	// line
		main.style.width  = 40*width + "px";	// column
		
		 alphaList = [];
		 
		 for (let i = 0; i < 20; i++) {
			    let row = document.createElement('tr');
			    for (let j = 0; j < 40; j++) {
			      let cell = document.createElement('td');
			      cell.setAttribute('id', String.fromCharCode(97 + j) + (i + 1));
			      cell.style.opacity = 0;
			      cell.textContent = String.fromCharCode(Math.random() * 26 + 65);
			      row.appendChild(cell);
			    }
			    table.appendChild(row);
			  }
		for (let s of spans) {
		    let line = s.dataset.line;
		    let column = s.dataset.column;

		    s.style.top = height*(line-1) + "px";
		    s.style.left = width*(column-1) + "px";
		    
		    setInterval(() => { // blink setting.
				if (s.style.display=='inline')
					s.style.display = 'none';
				else 
					s.style.display = 'inline';
			}, Math.random()*200 + 10);
		}
	}
</script>
</head>
<body>
	<main>
		<h1>Alpha Move</h1>
		<table border="1" style="border-color: pink">
			<tbody>
				<tr>
					<td id="td1">만든이</td>
					<td>손진희</td>
				</tr>
				<tr>
					<td id="td2">작성일</td>
					<td>2023/05/02</td>
				</tr>
				<tr>
					<td id="td3">과 목</td>
					<td>HTML/CSS/JAVASCRTIPT</td>
				</tr>
			</tbody>
		</table>
		<%
		for (int i=0; i<50; i++) {
			var a = new Alpha();
			var span = "<span data-line='%d' data-column='%d' style='color:%s; background:%s;'>%c</span>";
			span = String.format(span, a.getLine(), a.getColumn(), a.getFg(), a.getBg(), a.getCh());
			out.println(span);
			
		}
		%>

	</main>

</body>
</html>