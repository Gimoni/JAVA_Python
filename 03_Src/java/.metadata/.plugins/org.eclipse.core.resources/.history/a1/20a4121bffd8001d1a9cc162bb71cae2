package com.example.mapper;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import com.example.model.Alpha;

import util.Color;

	public class AlphaMapper {
		Connection conn;
		public AlphaMapper(Connection conn) {
			this.conn = conn;
		}
		
	public int selectCountAll() {
		String sql = """
				select count(*) as count
				  from alpha
				""";
		int rtn=0;
		
		Statement stmt = null;
		ResultSet rs = null;
		try {
			stmt = conn.createStatement();
			rs = stmt.executeQuery(sql);
			rs.next();
			rtn = rs.getInt("count");
		} catch (SQLException e) {
			e.printStackTrace();
		}finally {
			try {
				if (rs != null)
					rs.close();
				if (stmt != null)
					stmt.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
		}
		
		return rtn;
	}
	
	public int selectCountByLineColumn(int line, int column) {
		
		String sql = """
				select count(*) as count
				  from alpha
				 where line = ? and col = ? 
				""";
		
		int rtn = 0;
		
		try (var pstmt = conn.prepareStatement(sql);
			 var rs = pstmt.executeQuery();) {
			
			pstmt.setInt(1, line);
			pstmt.setInt(2, column);
			
			rs.next();
			rtn = rs.getInt("count");
		} catch (SQLException e) {
			e.printStackTrace();
		}
		
		return rtn;
	}
	
	public Alpha[] selectAll() {
		
		String sql = """
				select *
				  from alpha
				""";
		
		Alpha[] alphas = new Alpha[800];
		
		try (var stmt = conn.createStatement();
			 var rs = stmt.executeQuery(sql);) {
			
			
			while(rs.next()) {
				int no = rs.getInt("no");
				int line = rs.getInt("line");
				int column = rs.getInt("column");
				Color fg = Color.valueOf(rs.getString("fg"));
				Color bg = Color.valueOf(rs.getString("bg"));
				
				
			}
			
		} catch (SQLException e) {
			e.printStackTrace();
		}
		
		
		return alphas;
	}
	
	public int insertAlpha(Alpha alpha) {
		
		String sql = """
				insert into alpha
				(no, line, col, fg, bg, ch)
				values
				(?, ?, ?, ?, ?, ?)
				""";
		
		int rtn = 0;
		
		return rtn;
	}
	
	public int updateAlphaByLineColumn(Alpha alpha) {
		
		String sql = """
				update alpha
				   set no = ?,
				   	   fg = ?,
				   	   bg = ?,
				   	   ch = ?
				 where line = ? 
				""";
		
		int rtn = 0;
		
		return rtn;
	}
	
	public int deleteAll() {
		String sql = """
				delect from alpha
				""";
		
		int rtn = 0;
		
		return rtn;
	}
}
