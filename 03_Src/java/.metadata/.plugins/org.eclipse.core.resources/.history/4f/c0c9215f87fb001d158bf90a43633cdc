package com.example.mapper;

import java.sql.Date;
import java.util.List;

import org.apache.ibatis.annotations.Delete;
import org.apache.ibatis.annotations.Insert;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;
import org.apache.ibatis.annotations.Select;
import org.apache.ibatis.annotations.Update;

import com.example.model.Dept;
import com.example.model.Emp;
import com.example.util.Gender;

@Mapper
public interface EmpMapper {
	
	@Select("select count(*) from emp")
	int countAll();
	
	@Select("select * from emp")
	List<Emp> selectAll();
	
	@Select("""
			select *
			  from emp
			 where empno = #{empno} 
			""")
	Emp selectByEmpno(@Param("empno") int empno);
	
	@Insert("""
			insert into emp
			(empno, ename)
			values
			(#{empno}, #{ename, jdbcType=VARCHAR})
			""")
	int insertByEmpnoWithEname(@Param("empno") int empno, @Param("ename") String ename);
	
	@Insert("""
			insert into emp
			values (
				#{e.empno}, 
			 	#{e.ename,  	jdbcType=VARCHAR}, 
			 	#{e.gender, 	jdbcType=VARCHAR},
			 	#{e.job, 		jdbcType=VARCHAR},
			 	#{e.mgr, 		jdbcType=INTEGER},
			 	#{e.hiredate, 	jdbcType=DATE},
			 	#{e.sal, 		jdbcType=DOUBLE},
			 	#{e.comm, 		jdbcType=DOUBLE},
			 	#{e.deptno, 	jdbcType=INTEGER}
			)
			""")
	int insertEmp(@Param("e") Emp emp);
	
	@Update("""
			update emp
			   set empno     = #{e.empno}, 
			 	   ename     = #{e.ename,  	jdbcType=VARCHAR}, 
			 	   egender   = #{e.gender, 	jdbcType=VARCHAR},
			 	   ejob      = #{e.job, 		jdbcType=VARCHAR},
			 	   emgr      = #{e.mgr, 		jdbcType=INTEGER},
			 	   ehiredate = #{e.hiredate, 	jdbcType=DATE},
			 	   esal		 = #{e.sal, 		jdbcType=DOUBLE},
			 	   ecomm     = #{e.comm, 		jdbcType=DOUBLE},
			 	   edeptno   = #{e.deptno, 	jdbcType=INTEGER}

			 where deptno= ${deptno}     
			""")
	int update(@Param("empno") 		int empno, 
			   @Param("ename")  	String ename, 
			   @Param("egender")	Gender egender,
			   @Param("ejob")		String ejob,
			   @Param("emgr")		int emgr,
			   @Param("ehiredate")	Date ehiredate,
			   @Param("esal")		Double esal,
			   @Param("ecomm")		Double ecomm,
			   @Param("edeptno")	int edeptno);
	
	@Update("""
			update dept
			   set dname = #{d.dname, jdbcType=VARCHAR},
			       loc   = #{d.loc,   jdbcType=VARCHAR}
			 where deptno= ${d.deptno}     
			""")
	int updateDept(@Param("d") Dept dept);
	
	@Delete("delete from dept where deptno=#{deptno}")
	int delete(int deptno);

}
